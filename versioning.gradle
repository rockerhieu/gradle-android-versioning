def gitSha() {
  return "git --git-dir=${projectDir}/../.git --work-tree=${projectDir}/.. rev-parse --short HEAD".execute().text.trim()
}

def getCommitsCount() {
  return "git --git-dir=${projectDir}/../.git --work-tree=${projectDir}/.. rev-list --count HEAD".execute().text.toInteger()
}

ext.versionMajor = 1
ext.versionMinor = 0
ext.versionPatch = 0
ext.versionBuild = getCommitsCount()
ext.versionNameText = ("${versionMajor}.${versionMinor}.${versionBuild}." + gitSha())
ext.versionCodeValue = ((((versionMajor * 100) + versionMinor) * 100) * 100000 + versionBuild)

android {
  defaultConfig {
    packageName "${PACKAGE_NAME}"
    versionCode versionCodeValue
    versionName versionNameText
  }

  buildTypes {
    debug {
      packageNameSuffix ".debug"
    }

    release {
      packageNameSuffix ".release"
    }
  }
}
